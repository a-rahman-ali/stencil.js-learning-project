{"file":"home-component.entry.esm.js","mappings":";;;AAAA,MAAM,gBAAgB,GAAG,knCAAknC;;MCS9nC,aAAa;;;;QA8HxB,sBAAiB,GAAG,CAAC,KAA0B;YAC7C,MAAM,WAAW,GAAG,KAAK,CAAC,MAAM,CAAC;YACjC,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAA;YACxB,IAAI,WAAW,CAAC,IAAI,EAAE,KAAK,EAAE,EAAE;gBAC7B,MAAM,cAAc,GAAG,WAAW,CAAC,WAAW,EAAE,CAAC;gBACjD,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,OAAO,IACtD,OAAO,CAAC,cAAc,CAAC,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC,CACrE,CAAC;aACH;iBAAM;gBACL,IAAI,CAAC,gBAAgB,GAAG,EAAE,CAAC;aAC5B;SACF,CAAC;4BAvIqC,EAAE;gCACE,EAAE;;IAI7C,iBAAiB;QACf,IAAI,CAAC,aAAa,EAAE,CAAC;KACtB;IAED,MAAM,aAAa;QACjB,IAAI;YACF,MAAM,QAAQ,GAAG,MAAM,KAAK,CAAC,iBAAiB,CAAC,CAAC;YAChD,MAAM,IAAI,GAAG,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAC;YACnC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;SAC1B;QAAC,OAAO,KAAK,EAAE;YACd,OAAO,CAAC,KAAK,CAAC,0BAA0B,EAAE,KAAK,CAAC,CAAC;SAClD;KACF;IAED,MAAM,SAAS,CAAC,KAAkB;QAChC,IAAI,IAAI,CAAC,cAAc,EAAE,EAAE;YACzB,MAAM,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;SACjC;aAAM;YACL,IAAI,CAAC,qBAAqB,CAAC,KAAK,CAAC,CAAC;SACnC;KACF;IAED,cAAc;QACZ,MAAM,SAAS,GAAG,YAAY,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;QACpD,OAAO,CAAC,CAAC,SAAS,CAAC;KACpB;IAED,MAAM,aAAa,CAAC,KAAkB;QACpC,MAAM,SAAS,GAAG,YAAY,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;QACpD,IAAI,CAAC,SAAS,EAAE;YACd,OAAO,CAAC,KAAK,CAAC,wBAAwB,CAAC,CAAC;YACxC,OAAO;SACR;QAED,IAAI;;YAEF,MAAM,QAAQ,GAAG,MAAM,KAAK,CAAC,GAAG,cAAc,UAAU,SAAS,EAAE,CAAC,CAAC;YACrE,MAAM,KAAK,GAAG,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAC;YACpC,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC,EAAE;gBACtB,OAAO,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC;gBACjC,OAAO;aACR;YACD,MAAM,MAAM,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;;YAG3B,MAAM,YAAY,GAAG,MAAM,KAAK,CAAC,GAAG,cAAc,IAAI,MAAM,EAAE,CAAC,CAAC;YAChE,MAAM,IAAI,GAAG,MAAM,YAAY,CAAC,IAAI,EAAE,CAAC;YACvC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;;YAGzB,MAAM,KAAK,CAAC,GAAG,cAAc,IAAI,MAAM,EAAE,EAAE;gBACzC,MAAM,EAAE,KAAK;gBACb,OAAO,EAAE;oBACP,cAAc,EAAE,kBAAkB;iBACnC;gBACD,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC;aAC3B,CAAC,CAAC;YAEH,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;YAClC,IAAI,CAAC,uBAAuB,EAAE,CAAC;YAE/B,MAAM,aAAa,GAAG,MAAM,IAAI,CAAC,sBAAsB,EAAE,CAAC;YAC1D,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;SAE/C;QAAC,OAAO,KAAK,EAAE;YACd,OAAO,CAAC,KAAK,CAAC,uBAAuB,EAAE,KAAK,CAAC,CAAC;SAC/C;KACF;IAED,qBAAqB,CAAC,KAAkB;QACtC,IAAI,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,IAAI,CAAC,CAAC;QACpE,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;QACxB,YAAY,CAAC,OAAO,CAAC,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC;QAC3D,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;QAClC,IAAI,CAAC,uBAAuB,EAAE,CAAC;QAC/B,IAAI,CAAC,sBAAsB,EAAE,CAAC,IAAI,CAAC,aAAa;YAC9C,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;SAC/C,CAAC,CAAC,KAAK,CAAC,KAAK;YACZ,OAAO,CAAC,KAAK,CAAC,oCAAoC,EAAE,KAAK,CAAC,CAAC;SAC5D,CAAC,CAAC;KACJ;IAED,kBAAkB,CAAC,SAAiB;QAClC,MAAM,eAAe,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,IAAI,OAAO,CAAC,EAAE,KAAK,SAAS,CAAC,CAAC;QACpF,IAAI,eAAe,EAAE;YACnB,eAAe,CAAC,eAAe,CAAC,EAAE,CAAC;SACpC;KACF;IAED,uBAAuB;QACrB,IAAI,CAAC,YAAY,GAAG,CAAC,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC;KAC5C;IAED,MAAM,sBAAsB;QAC1B,IAAI,IAAI,CAAC,cAAc,EAAE,EAAE;YACzB,MAAM,SAAS,GAAG,YAAY,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;YACpD,IAAI;gBACF,MAAM,QAAQ,GAAG,MAAM,KAAK,CAAC,GAAG,cAAc,UAAU,SAAS,EAAE,CAAC,CAAC;gBACrE,IAAI,IAAI,GAAG,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAC;gBACjC,IAAI,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;gBACf,OAAO,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;aACzB;YAAC,OAAO,KAAK,EAAE;gBACd,OAAO,CAAC,KAAK,CAAC,sBAAsB,EAAE,KAAK,CAAC,CAAC;gBAC7C,OAAO,CAAC,CAAC;aACV;SACF;aAAM;YACL,MAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,IAAI,CAAC,CAAC;YACtE,OAAO,QAAQ,CAAC,MAAM,CAAC;SACxB;KACF;IAED,gBAAgB;QACd,QAAQ,CAAC,gBAAgB,CAAC,aAAa,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;KAClE;IAED,oBAAoB;QAClB,QAAQ,CAAC,mBAAmB,CAAC,aAAa,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;KACrE;IAeD,MAAM;QACJ,IAAI,iBAAiB,GAAG,IAAI,CAAC,gBAAgB,CAAC,MAAM,GAAG,CAAC,GAAG,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,YAAY,CAAC;QAErG,IAAI,cAAc,GAAG,EAAE,CAAC;QACxB,IAAI,iBAAiB,CAAC,MAAM,GAAG,CAAC,EAAE;YAChC,cAAc,IACZ,4DAAK,KAAK,EAAC,YAAY,IACpB,iBAAiB,CAAC,GAAG,CAAC,KAAK,KAC1B,WAAK,KAAK,EAAC,YAAY,EAAC,GAAG,EAAE,KAAK,CAAC,EAAE,IACnC,WAAK,GAAG,EAAE,KAAK,CAAC,aAAa,CAAC,EAAE,GAAG,EAAE,KAAK,CAAC,cAAc,CAAC,GAAI,EAC9D,cAAK,KAAK,CAAC,cAAc,CAAC,CAAM,EAChC,+BAAa,KAAK,CAAC,eAAe,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAK,EACnD,aAAI,KAAK,CAAC,eAAe,CAAC,GAAG,CAAC,GAAG,UAAU,GAAG,cAAc,CAAK,EACjE,cAAQ,QAAQ,EAAE,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,CAAC,kBAAsB,CAC1G,CACP,CAAC,CACE,CACP,CAAA;SACF;aAAM;YACL,cAAc,IAAI,yEAAmC,CAAC,CAAA;SACvD;QAED,QACE,EAAC,IAAI,uDACH,0EAAqC,EACpC,cAAc,CACV,EACP;KACH;;;;;;","names":[],"sources":["src/components/home-component/home-component.css?tag=home-component&encapsulation=shadow","src/components/home-component/home-component.tsx"],"sourcesContent":[":host {\n  display: block;\n  background-image: url(\"https://png.pngtree.com/thumb_back/fw800/background/20240204/pngtree-smart-watches-floating-in-ramadan-themed-background-image_15596011.png\");\n  background-repeat: no-repeat;\n  background-size: cover;\n  background-position: center;\n  min-height: 100vh;\n\n}\n\n.watch-list {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 16px;\n  justify-content: center;\n  margin-top: 6%;\n}\n\n.watch-card {\n  border: 1px solid white;\n  border-radius: 8px;\n  padding: 10px;\n  text-align: center;\n  width: 200px;\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\n  transition: transform 0.2s;\n}\n\n.watch-card:hover {\n  transform: scale(1.05);\n}\n\n.watch-card img {\n  max-width: 100%;\n  height: 150px;\n  border-bottom: 1px solid rgb(221, 221, 221);\n  padding-bottom: 8px;\n  margin-bottom: 8px;\n  border: 1px solid white;\n}\n\n.watch-card h2 {\n  font-size: 19.2px;\n  margin: 0;\n  color: white;\n}\n\n.watch-card p {\n  margin: 8px 0;\n  color: white;\n}\n\n.watch-card button {\n  background-color: rgb(0, 123, 255);\n  border: none;\n  border-radius: 4px;\n  color: rgb(255, 255, 255);\n  cursor: pointer;\n  padding: 8px 16px;\n  font-size: 16px;\n  transition: background-color 0.2s;\n}\n\n.watch-card button:hover {\n  background-color: rgb(0, 86, 179);\n}\n\n.watch-card button:disabled {\n  background-color: rgb(221, 221, 221);\n  cursor: not-allowed;\n}","import { Component, Host, h, State, Event, EventEmitter } from '@stencil/core';\nimport { ISmartwatch } from '../../interfaces/ISmartWatch';\nimport { products_endpoint, users_endpoint } from '../../interfaces/endpoints';\n\n@Component({\n  tag: 'home-component',\n  styleUrl: 'home-component.css',\n  shadow: true,\n})\nexport class HomeComponent {\n\n  @State() smartwatches: ISmartwatch[] = [];\n  @State() filteredProducts: ISmartwatch[] = [];\n  @Event({ eventName: 'cartItemCountUpdated', bubbles: true, composed: true }) cartItemCountUpdated: EventEmitter<number>;\n\n\n  componentWillLoad() {\n    this.fetchProducts();\n  }\n\n  async fetchProducts() {\n    try {\n      const response = await fetch(products_endpoint);\n      const data = await response.json();\n      this.smartwatches = data;\n    } catch (error) {\n      console.error('Error fetching products:', error);\n    }\n  }\n\n  async addToCart(watch: ISmartwatch) {\n    if (this.isUserLoggedIn()) {\n      await this.addToUserCart(watch);\n    } else {\n      this.addToLocalStorageCart(watch);\n    }\n  }\n\n  isUserLoggedIn(): boolean {\n    const userEmail = localStorage.getItem('useremail');\n    return !!userEmail;\n  }\n\n  async addToUserCart(watch: ISmartwatch) {\n    const userEmail = localStorage.getItem('useremail');\n    if (!userEmail) {\n      console.error('User is not logged in.');\n      return;\n    }\n\n    try {\n      // Fetch user details to get user ID\n      const response = await fetch(`${users_endpoint}?email=${userEmail}`);\n      const users = await response.json();\n      if (users.length === 0) {\n        console.error('User not found.');\n        return;\n      }\n      const userId = users[0].id;\n\n      // Fetch user by ID to update cart\n      const userResponse = await fetch(`${users_endpoint}/${userId}`);\n      const user = await userResponse.json();\n      user.cart.push(watch.id);\n\n      // Update user's cart\n      await fetch(`${users_endpoint}/${userId}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(user),\n      });\n\n      this.reduceProductCount(watch.id);\n      this.updateSmartwatchesState();\n\n      const cartItemCount = await this.calculateCartItemCount();\n      this.cartItemCountUpdated.emit(cartItemCount); // Emit event to update cart count in NavBar\n\n    } catch (error) {\n      console.error('Error adding to cart:', error);\n    }\n  }\n\n  addToLocalStorageCart(watch: ISmartwatch) {\n    let tempCart = JSON.parse(localStorage.getItem('tempCart') || '[]');\n    tempCart.push(watch.id);\n    localStorage.setItem('tempCart', JSON.stringify(tempCart));\n    this.reduceProductCount(watch.id);\n    this.updateSmartwatchesState();\n    this.calculateCartItemCount().then(cartItemCount => {\n      this.cartItemCountUpdated.emit(cartItemCount); // Emit event to update cart count in NavBar\n    }).catch(error => {\n      console.error('Error calculating cart item count:', error);\n    });\n  }\n\n  reduceProductCount(productId: string) {\n    const productToUpdate = this.smartwatches.find(product => product.id === productId);\n    if (productToUpdate) {\n      productToUpdate['product-count']--;\n    }\n  }\n\n  updateSmartwatchesState() {\n    this.smartwatches = [...this.smartwatches];\n  }\n\n  async calculateCartItemCount(): Promise<number> {\n    if (this.isUserLoggedIn()) {\n      const userEmail = localStorage.getItem('useremail');\n      try {\n        const response = await fetch(`${users_endpoint}?email=${userEmail}`);\n        let user = await response.json();\n        user = user[0];\n        return user.cart.length;\n      } catch (error) {\n        console.error('Error fetching user:', error);\n        return 0; // Return 0 in case of error\n      }\n    } else {\n      const tempCart = JSON.parse(localStorage.getItem('tempCart') || '[]');\n      return tempCart.length;\n    }\n  }\n\n  componentDidLoad() {\n    document.addEventListener('searchEvent', this.handleSearchEvent);\n  }\n\n  disconnectedCallback() {\n    document.removeEventListener('searchEvent', this.handleSearchEvent);\n  }\n\n  handleSearchEvent = (event: CustomEvent<string>) => {\n    const searchQuery = event.detail;\n    console.log(searchQuery)\n    if (searchQuery.trim() !== '') {\n      const lowercaseQuery = searchQuery.toLowerCase();\n      this.filteredProducts = this.smartwatches.filter(product =>\n        product['product-name'].toLowerCase().indexOf(lowercaseQuery) !== -1\n      );\n    } else {\n      this.filteredProducts = []; // Clear filtered products if search query is empty\n    }\n  };\n\n  render() {\n    let productsToDisplay = this.filteredProducts.length > 0 ? this.filteredProducts : this.smartwatches;\n\n    let loadedProducts = '';\n    if (productsToDisplay.length > 0) {\n      loadedProducts = (\n        <div class=\"watch-list\">\n          {productsToDisplay.map(watch => (\n            <div class=\"watch-card\" key={watch.id}>\n              <img src={watch['product-url']} alt={watch['product-name']} />\n              <h2>{watch['product-name']}</h2>\n              <p>Price: â‚¹ {watch['product-price'].toFixed(2)}</p>\n              <p>{watch['product-count'] > 0 ? 'In Stock' : 'Out of Stock'}</p>\n              <button disabled={watch['product-count'] <= 0} onClick={this.addToCart.bind(this, watch)}>Add to Cart</button>\n            </div>\n          ))}\n        </div>\n      )\n    } else {\n      loadedProducts = (<loading-spinner></loading-spinner>)\n    }\n\n    return (\n      <Host>\n        <header-component></header-component>\n        {loadedProducts}\n      </Host>\n    );\n  }\n\n\n}\n"],"version":3}